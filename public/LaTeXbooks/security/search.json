["セキュリティ tomixy since 2021/11/6 目次 第 I 部 セキュリティマネジメント 1 第 II 部 情報に関する法律 1 第 III 部 不正アクセスの防止 1 1 ユーザ認証の手法 2 2 不注意による情報漏洩 2 3 不正アクセスの手法と対策 3 4 不正アクセス後の攻撃ツール 4 第 IV 部 コンピュータウイルス 5 5 コンピュータウイルスの定義 5 6 コンピュータウイルスの種類 5 7 悪意のあるプログラム 6 i ","目次 ii 8 ウイルス対策とウイルス検出 6 第 V 部 ネットワークのセキュリティ対策 7 第 VI 部 通信経路のセキュリティ 8 9 盗聴の防止 8 10 改ざんの防止 9 11 なりすましの防止 10 12 共通鍵暗号方式で用いられるアルゴリズム 10 13 公開鍵暗号方式で用いられるアルゴリズム 11 14 デジタル署名で用いられるハッシュ関数 11 ","1 第 I 部 セキュリティマネジメント 情報セキュリティは、次の 3 つの要素を管理して、うまくバランスをとることが大切だと されている。 • 許可された人だけが情報にアクセスできるようにするなどして、 情報が漏洩しないようにする 機密性 • 情報が書き換えられたりすることなく、完全な状態を保つ 完全性 • 利用者が、必要な時に必要な情報資産を利用できるようにする 可用性 情報セキュリティ対策に企業としてどう取り組むかを明文化したものを セキュリティポリシ といい、次の 3 階層で構成されている。 1. 企業としての 基本方針 2. 上の方針を実現するために行うべき 対策基準 3. 業務の中でどのように実施していくかの具体的な 実施手順 第 II 部 情報に関する法律 個人情報保護法 は、個人情報を事業者が適切に取り扱うためのルールを定めたもので ある。 個人情報に関する認定制度として プライバシーマーク制度 があり、これは、 JIS Q 15001 （ 個人情報保護マネジメントシステムー要求事項 ）に適合して、個人情報の適切な保護体 制が整備できている事業者を認定するものである。 ","2 第 III 部 不正アクセスの防止 1 ユーザ認証の手法 バイオメトリクス認証 （ 生体認証 ）は、 • 指紋 • 声帯 • 虹彩 などの身体的特徴を使って個人を識別する認証方法である。 ワンタイムトークン は、一度限り有効という、使い捨てのパスワードを用いる認証方法 である。 トークン と呼ばれる ワンタイムパスワード生成器 を使う形が一般的。 コールバック は、遠隔地からサーバへ接続する場合などに、 1. 一旦アクセスした後で回線を切る 2. 逆にサーバ側から コールバック （着信側から再発信）させる ことで、アクセス権を確認する認証方法である。 2 不注意による情報漏洩 コンピュータシステムとは関係のないところで、人の心理的不注意をついて情報資産を盗 み出す行為を ソーシャルエンジニアリング という。 具体的には、 • 肩越しにパスワードを盗み見る ショルダーハッキング • ゴミ箱を漁って有用な情報を盗み出す スキャビンジング • 身分を詐称してパスワードや機密情報を聞き出す • 付箋などに書いていたパスワードを覚えられてしまう ","3 などの行為が該当する。 3 不正アクセスの手法と対策 辞書攻撃 は、辞書に載っている単語などを元に、パスワードで使われそうな文字列を辞 書化し、これを片っ端から試すことによりパスワードを破ろうとする手法である。 • ランダムな値 でパスワードを設定する などの対処法が考えられる。 ブルートフォース （ Brote force ） 攻撃 は、認証に用いられる文字列全ての組合せを試 すことでパスワードを破ろうとする手法である。 • ログイン試行回数に制限 を設ける などの対処法が考えられる。 スニッフィング は、ネットワークに流れるパケットを盗聴し、その内容からパスワード を取得しようとする手法である。 • パスワードを 平文 で送信しない などの対処法が考えられる。 ゼロデイ攻撃 は、ソフトウェアの脆弱性発覚後、対応策（ セキュリティパッチ ）が配布 される前にその脆弱性を利用した攻撃を行うことである。 クロスサイトスクリプティング は、閲覧者が投稿を行うことのできる入力フォームから 悪意のあるスクリプトを送り込むことで、それをページ内に埋め込む攻撃手法である。 他の閲覧者がこのページにアクセスすると、埋め込まれたスクリプトが自動的に実行さ れる。 • 入力フォームかた送られてきた内容を検査し、 そこに含まれるスクリプトなどを無害な文字列に置き換える サニタイジング ","4 などが対処法となる。 フィッシング は、金融機関などを装った偽造 Web サイトに利用者を誘導し、暗証番号を はじめとする個人情報を不正に取得しようとする手法である。 多くの場合、誘導には正規業者を装った 電子メール などが利用される。 • 送信者情報を信用せず、送信元の URL が本物であるか確認する などの対処法が考えられる。 DES キャッシュポイズニング は、DNS のキャッシュ機能を悪用して、一時的に偽のド メイン情報を覚えさせることで偽装 Web サイトへと誘導する手法である。 • DNS キャッシュサーバが 問合せに対する応答を電子署名で検証できるようにする DNSSEC が根本的な対処法となる。 ディレクトリトラバーサル攻撃 は、ファイルやパスをパラメータとして受け取るプログ ラムに対して、想定外の 相対パス を渡すことで、本来公開対象ではないはずのファイル やディレクトリにアクセスする手法である。 • パラメータ チェックにより、不正な パス を削除する などの対処法が考えられる。 4 不正アクセス後の攻撃ツール 不正アクセスに成功したコンピュータ内に潜伏し、攻撃者がそのコンピュータをリモート 制御できるようにするソフトウェアの集合体を rootkit （ ルートキット ）といい、 • 侵入の痕跡を隠蔽するための ログ改ざん ツール • リモートからの侵入を容易にする バックドア ツール • 侵入に気づかれないよう改ざんを行った システム ツール群 ","5 などが含まれている。 第 IV 部 コンピュータウイルス 5 コンピュータウイルスの定義 経済産業省 の「 コンピュータウイルス対策基準 」によると、 次の 3 つの基準のうち、どれか一つを有すればコンピュータウイルスであるとしている。 • 自分のコピーを他のコンピュータにも生成して感染を広げる 自己伝染機能 • 対策を遅らせる狙いなどで、感染後もしばらくはおとなしくしている 潜伏機能 • プログラムやデータを破壊したり、予期しない動作を行う 発病機能 6 コンピュータウイルスの種類 狭義のウイルス は、他のプログラムに寄生して、その機能を利用する形で発病するもの である。 マクロウイルス は、アプリケーションのもつマクロ機能などを悪用したもので、ワープ ロソフトや表計算ソフトのデータファイルに寄生して感染を広げる。 ワーム は、自身単独で複製を生成しながら、ネットワークなどを介してコンピュータ間 に感染を広めるものである。 作成が容易なため、種類が急増している。 トロイの木馬 は、有用なプログラムであるとうに見せかけてユーザに実行を促し、その 裏で不正な処理（データのコピーやコンピュータの悪用など）を行うものである。 ","6 7 悪意のあるプログラム マルウェア は、悪意のあるソフトウェア全般を表す言葉で、コンピュータウイルスもこ の一種である。 スパイウェア は、情報収集を目的としたプログラムで、コンピュータ利用者の個人情報 を収集して外部に送信する。 他の有用なプログラムに紛れて、気づかないうちにインストールされるケースが多く見ら れる。 ボット は、感染した第 3 者のコンピュータを、作成者の指示通りに動かすものである。 • 迷惑メールを送信する • 他のコンピュータを攻撃する などの 踏み台 に利用される恐れがある。 8 ウイルス対策とウイルス検出 コンピュータウイルスに対して効力を発揮するのが ウイルス対策ソフト であり、 • コンピュータに入ってきたデータを最初に スキャン して、 問題がないかを確認する • コンピュータの中を検査してウイルス感染チェックを行う • 既に感染してしまったファイルを隔離・修復する などの役割を担う。 ウイルス対策ソフトが多種多様なウイルスを検出するためには、既知ウイルスの特徴を記 録した ウイルス定義ファイル （ シグネチャ ）が欠かせない。 ウイルスは常に新種が発見されているため、このファイルも常に最新の状態を保つことが ","7 大切である。 ウイルス定義ファイルでは既知のウイルスしか検出できないが、実行中のプログ ラムの挙動を監視して、不審な処理が行われないか検査する手法を ビヘイビア法 （ 動的ヒューリスティック法 ）という。 検知と同時に感染してしまわないよう、 • 危険な動作が検出されたら即座にプログラムを 停止 • 仮想環境 で実行させてみて、危険な行動をとるか監視 などの方法をとっている。 第 V 部 ネットワークのセキュリティ対策 LAN の中と外を区切る壁としての機能を ファイアウォール といい、「外部からの不正ア クセスを火事とみなして、それを食い止める防火壁」という意味でこの名がつけられた。 主な実現方法として、 • 濾過フィルタのように、予め指定されたルールに則ってパケットの通過可否を制御 する パケットフィルタリング • 門番のように LAN の外と中の間に位置して、外部とのやりとりを代行する アプリケーションゲートウェイ （ プロキシサーバ 、 代理サーバ ） などがある。 パケットフィルタリングでは、 • 送信元 IP アドレス • 宛先 IP アドレス • プロトコル 種別 • ポート番号 ","8 などを含むパケットの ヘッダ情報 を見て、通過の可否を判定する。 アプリケーションが提供するサービスは プロトコル と ポート番号 で区別されるため、 「どの サービス を通過させるか」という基準で判断していることになる。 アプリケーションゲートウェイを導入することで、 外のコンピュータからは プロキシサーバ しか見えなくなるため、LAN 内のコンピュータ が不正アクセスの標的になることを防ぐことができる。 アプリケーションゲートウェイ型の ファイアウォール である WAF （ Web Application Firewall ）は、パケットのヘッダだけではなく、データの中 身までチェックすることで悪意をもった攻撃を検知する。 既知の手法を用いて実際に攻撃を行い、システムのセキュリティホールや設定ミスといっ た脆弱性の有無を確認するテストを ペネトレーションテスト という。 第 VI 部 通信経路のセキュリティ 9 盗聴の防止 送り手（暗号化する側）と受け手（復号する側）が同じ鍵を用いる暗号化方式 を 共通鍵暗号方式 という。 この鍵は第 3 者に知られると意味がなくなるため、この方式は 秘密鍵暗号方式 とも呼ば れるが、「鍵自体をどのようにして安全に受け渡すか」という問題が残る。 相手に送る鍵を覗かれても大丈夫なように考案されたのが 公開鍵暗号方式 であり、次の ような手順で暗号化通信を行う。 1. 受信者が暗号化に使う 公開鍵 と復号に使う 秘密鍵 のペアを用意する 2. 受信者は自分の 公開鍵 を全世界に公開する 3. 受信者に対して暗号化通信をしたい人は、公開されている 公開鍵 で暗号化を行う ","9 4. 暗号化されたデータは、受信者だけがもつ 秘密鍵 でしか解読できない このように、知られてはいけない鍵をネットワーク上に流すことがないため、盗聴のリス クがなくなるが、 暗号化や復号に非常に 処理時間 がかかるというデメリットもある。 10 改ざんの防止 公開鍵暗号方式では、 • 公開鍵で暗号化したものは秘密鍵でしか復号できない • 秘密鍵で暗号化したものは公開鍵でしか復号できない という関係が成り立つ。 このことを利用して、 • 途中で改ざんされていないか • 誰が送信したものか を確認できるようにした仕組みを デジタル署名 という。 デジタル署名は、具体的に次のような仕組みになっている。 1. ハッシュ化 という手法で、 送信したいデータ本文の短い要約データ（ メッセージダイジェスト ）を作成し、 それを 秘密鍵 で暗号化する 2. 上の暗号化データ（デジタル署名）を本文に添えて送信する 3. 受信者は 公開鍵 を使って、デジタル署名を復号する 4. 受信した本文から、送信時と同様の手順で メッセージダイジェスト を作成する 「元データが同じであれば、 ハッシュ関数 は同じ ハッシュ値 を生成する」という性質か ら、復号したデジタル署名と新たに生成した メッセージダイジェスト が一致すれば、送 信前のデータも受信後のデータも同一であるといえる。 これにより、対応する 秘密鍵 をもつ人から、データが途中で改ざんされることなく送ら ","10 れてきたことがわかる。 11 なりすましの防止 「ペアの鍵を作った人物が既に偽物だった」というなりすましの危険性を排除するため、 鍵の所有主が確かに本人であることを信頼できる第 3 者が証明する機構が考えられた。 具体的に、次のような流れによって公開鍵の正当性を保証する。 1. 公開鍵を 認証局 （ CA ： Certification Authority ） に登録し、 デジタル証明書 を発行してもらう 2. デジタル証明書 付きの公開鍵で復号できるものは、 確かに本人のもつ秘密鍵によって暗号化されたものだとわかる 認証機関と公開鍵暗号技術を用いて通信の安全性を保証する仕組みのことを、 公開鍵基盤 （ PKI ： Public Key Infrastructure ）という。 12 共通鍵暗号方式で用いられるアルゴリズム DES （ Data Encryption Standard ）は、次のような特徴をもつ。 • 平文を一定のブロック長に区切って暗号化する ブロック暗号 方式 • 鍵長は 64 ビット（実質は 56 ビット • 256 の鍵パターンをもつ 共通鍵暗号方式で最も代表的な暗号アルゴリズムだが、コンピュータの高性能化に伴い、 ブルートフォース攻撃 による解読が現実的な時間で行えるようになってしまったため、 後継の AES へと代替が進められている。 AES （ Advanced Encryption Standard ）は、次のような特徴をもつ。 • DES と同じく ブロック暗号 方式 • 鍵長は 128 ビット・ 192 ビット・ 256 ビットの 3 種から選択できる ","11 共通鍵暗号方式の現在のデファクトスタンダードである。 13 公開鍵暗号方式で用いられるアルゴリズム RSA は、次のような特徴をもつ。 • 開発者である 3 人の頭文字を繋げて命名された •「桁数が大きければその 素因数分解 には膨大な時間を要する」 という性質が安全性を保証している • 利用する鍵長には 1024 ～ 4096 ビットが推奨されている 公開鍵暗号方式において最も代表的なアルゴリズムである。 14 デジタル署名で用いられるハッシュ関数 MD5 （ Message Digest Algorithm 5 ）は、次のような特徴をもつ。 • 与えられた入力に対して、 128 ビットのメッセージダイジェストを生成 • RSA 暗号方式 の開発者によって作られた • ファイル配布時に破損などがないか確認する チェックサム としてもよく用いら れる 2004 年に脆弱性が発見され、現在は使われていない。 SHA （ Secure Hash Algorithm ） -1 は、次のような特徴をもつ。 • 与えられた入力に対して、 160 ビットのメッセージダイジェストを生成 • 米国の 国家安全保証局 （ NSA ）が開発した 2005 年あたりから脆弱性が発見され始め、現在は後継である SHA-2 への移行が進めら れている。 SHA-1 の後継である SHA-2 には、次のような特徴がある。 ","12 • 様々なバリエーションがあり、 それぞれ 224 ～ 512 ビットのメッセージダイジェストを生成 • S/MIME など、広い範囲で用いられている "]